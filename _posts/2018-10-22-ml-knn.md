---
title: 【ML】1 k-近邻
date: 2018-10-22 18:54:31
---

```python
import numpy as np
import operator
from sklearn.datasets import load_boston

def mykNN(X_train, y_train, X_test, K):
    # 计算欧式距离
    diff = X_train - X_test
    squaredDiff = diff ** 2
    squaredDist = np.sum(squaredDiff, axis=1)
    dist = squaredDist ** 0.5


    # 对距离进行排序
    sortedDistIndex = np.argsort(dist)
    indexCount={}
    for i in range(K):
        vote = y_train[sortedDistIndex[i]]
        indexCount[vote] = indexCount.get(vote, 0) + 1


    # 选出得票最高的点
    maxCount = 0
    for key,value in classCount.items():
        if value > maxCount:
            maxCount = value
            pred = key




    # 返回该点对应的结果
    return pred

boston = load_boston()
point = 5
X_train, X_test, y_train, y_test = boston.data[point:], boston.data[:point], boston.target[point:],boston.target[:point]  
K = 5
y_pred = mykNN(X_train, y_train, X_test[0], K)



```
